# where the template is
_subdirectory: template

# questions
project_name:
  type: str
  help: What is the project name?

pkg_name:
  type: str
  help: Top level Python package name
  default: "{{ project_name|lower|replace(' ', '_') }}"

version: 0.1.0

project_type:
  type: str
  help: What type of project is this?
  choices:
    - simple
    - quart

db_type:
  type: str
  help: what database is used in the project?
  choices:
    - none
    - sqlite
    - postgresql

use_docker:
  type: bool
  default: false
  help: Generate Dockerfile and script for building container image?

use_devcontainer:
  type: bool
  default: false
  help: Generate devcontainer.json?

use_github_action:
  type: bool
  default: false
  help: Generate GitHub action for building, unit test and building container image?

_message_after_copy: |
  the project has been generated under "{{ project_name }}"

  typically steps after generation:

    cd "{{ _copier_conf.dst_path }}"
    uv sync
    source .venv/bin/activate
    ruff check --fix .

  consult README.md for more details

_tasks:
  - git init .
  - git checkout -b develop
  - git add .gitignore .pre-commit-config.yaml .copier-answers.yml .vscode .python-version
  - >-
    {% if use_github_action %}
    git add .github
    {% else %}
    rm -rf .github
    {% endif %}
  - >-
    {% if use_devcontainer %}
    git add .devcontainer
    {% else %}
    rm -rf .devcontainer
    {% endif %}
  - >-
    {% if use_docker %}
    git add Dockerfile entrypoint.sh .dockerignore
    {% else %}
    rm Dockerfile entrypoint.sh .dockerignore
    {% endif %}
  - >-
    {% if db_type == "none" %}
    rm -rf migrations {{ pkg_name }}/models.py tests/test_models.py
    {% endif %}
  - git add *
  - git commit -m "generated by copier"
